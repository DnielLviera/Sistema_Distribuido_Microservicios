version: '3.8'

services:
  # Auth Service - Python
  auth-service:
    build: ./auth-service
    ports:
      - "8000:8000"
    environment:
      - SECRET_KEY=clave-super-segura-para-docker
      - PORT=8000
    volumes:
      - ./auth-service/users.json:/app/users.json
    networks:
      - microservices-network

  # Products Service - PHP
  products-service:
    build: ./products-service
    ports:
      - "8001:8001"
    environment:
      - SECRET_KEY=clave-super-segura-para-docker
      - PORT=8001
    volumes:
      - ./products-service/products.json:/var/www/html/products.json
      - ./products-service/last_id.txt:/var/www/html/last_id.txt
    depends_on:
      - auth-service
    networks:
      - microservices-network

  # Inventory Service - Rust
  inventory-service:
    build: ./inventory-service
    ports:
      - "8002:8002"
    environment:
      - SECRET_KEY=clave-super-segura-para-docker
      - PORT=8002
    volumes:
      - ./inventory-service/inventory.json:/app/inventory.json
    depends_on:
      - auth-service
      - products-service
    networks:
      - microservices-network

  # Frontend (opcional por ahora)
  # frontend:
  #   build: ./frontend
  #   ports:
  #     - "3000:3000"
  #   depends_on:
  #     - auth-service
  #     - products-service
  #     - inventory-service
  #   networks:
  #     - microservices-network

networks:
  microservices-network:
    driver: bridge